import streamlit as st

st.set_page_config(page_title="ğŸ¬ ë‚˜ì™€ ì–´ìš¸ë¦¬ëŠ” ì˜í™”ëŠ”?", page_icon="ğŸ¬", layout="centered")

st.title("ğŸ¬ ë‚˜ì™€ ì–´ìš¸ë¦¬ëŠ” ì˜í™”ëŠ”?")
st.write("5ê°œì˜ ì§ˆë¬¸ì— ë‹µí•˜ë©´, ë‹¹ì‹ ì˜ ì·¨í–¥ì— ì–´ìš¸ë¦¬ëŠ” ì˜í™” ì¥ë¥´ë¥¼ ì°¾ì•„ë“œë ¤ìš”! ğŸ¿")
st.caption("â€» ì§€ê¸ˆì€ í™”ë©´ êµ¬ì„± ë‹¨ê³„ì˜ˆìš”. ë‹¤ìŒ ì‹œê°„ì— TMDB APIë¡œ ì‹¤ì œ ì˜í™” ì¶”ì²œì„ ë¶™ì¼ ê±°ì˜ˆìš”.")

st.divider()

# ì§ˆë¬¸ ë°ì´í„°
questions = [
    {
        "q": "Q1. ì‹œí—˜ ëë‚œ ë‚ , ë‚´ê°€ ê°€ì¥ í•˜ê³  ì‹¶ì€ ì¼ì€?",
        "options": [
            "â¤ï¸ ì¡°ìš©í•œ ì¹´í˜ì—ì„œ ì¹œêµ¬ë‘ ê¹Šì€ ì–˜ê¸°í•˜ë©° íë§í•˜ê¸°",
            "ğŸ”¥ ë‹¹ì¥ ì–´ë””ë¡ ê°€ ë– ë‚˜ì„œ ìƒˆë¡œìš´ ê²½í—˜í•˜ê¸°",
            "ğŸŒŒ ê²Œì„ì´ë‚˜ ì˜í™”ë¡œ í˜„ì‹¤ì„ ë²—ì–´ë‚˜ ë‹¤ë¥¸ ì„¸ê³„ë¡œ ê°€ê¸°",
            "ğŸ˜‚ ì¹œêµ¬ë“¤ì´ë‘ ì›ƒê¸´ ì˜ìƒ ë³´ë©´ì„œ ìŠ¤íŠ¸ë ˆìŠ¤ ë‚ ë¦¬ê¸°",
        ],
    },
    {
        "q": "Q2. ì¹œêµ¬ë“¤ì´ ë§í•˜ëŠ” ë‚˜ì˜ ë¶„ìœ„ê¸°ëŠ”?",
        "options": [
            "â¤ï¸ ê°ì„±ì ì´ê³  ê³µê° ì˜í•˜ëŠ” í¸",
            "ğŸ”¥ ì—ë„ˆì§€ ë„˜ì¹˜ê³  ë„ì „ì ì¸ í¸",
            "ğŸŒŒ ìƒìƒë ¥ì´ í’ë¶€í•˜ê³  ë…íŠ¹í•œ í¸",
            "ğŸ˜‚ í•­ìƒ ë¶„ìœ„ê¸° ë©”ì´ì»¤ì¸ í¸",
        ],
    },
    {
        "q": "Q3. ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ì—¬í–‰ ìŠ¤íƒ€ì¼ì€?",
        "options": [
            "â¤ï¸ ì˜ˆìœ í’ê²½ ë³´ë©´ì„œ ì—¬ìœ ë¡­ê²Œ ì‚°ì±…í•˜ëŠ” ì—¬í–‰",
            "ğŸ”¥ ì•¡í‹°ë¹„í‹° ê°€ë“í•œ ëª¨í—˜ ì—¬í–‰",
            "ğŸŒŒ ì‹ ë¹„ë¡œìš´ ì¥ì†Œë‚˜ í…Œë§ˆíŒŒí¬ ê°™ì€ íŒíƒ€ì§€ ì—¬í–‰",
            "ğŸ˜‚ ì¹œêµ¬ë“¤ê³¼ ì‚¬ê±´(?)ì´ ëŠì´ì§€ ì•ŠëŠ” ìš°ë‹¹íƒ• ì—¬í–‰",
        ],
    },
    {
        "q": "Q4. ìƒˆ í•™ê¸° ì²«ë‚ , ë‚´ê°€ ê°€ì¥ ì‹ ê²½ ì“°ëŠ” ê±´?",
        "options": [
            "â¤ï¸ ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì™€ ë¶„ìœ„ê¸°",
            "ğŸ”¥ ìƒˆë¡œìš´ í™œë™ì´ë‚˜ ë™ì•„ë¦¬ ë„ì „",
            "ğŸŒŒ ë‚´ê°€ ì¢‹ì•„í•  ë§Œí•œ ìƒˆë¡œìš´ ì„¸ê³„(ì·¨ë¯¸)ë¥¼ ì°¾ê¸°",
            "ğŸ˜‚ ì¬ë°ŒëŠ” ì¹œêµ¬ë“¤ ë§Œë‚˜ì„œ ì›ƒê¸¸ ê¸°ëŒ€",
        ],
    },
    {
        "q": "Q5. ì˜í™” ì† ì£¼ì¸ê³µì´ ëœë‹¤ë©´ ë‚˜ëŠ”?",
        "options": [
            "â¤ï¸ ì‚¬ë‘ê³¼ ì„±ì¥ ì†ì—ì„œ ê°ë™ì„ ì£¼ëŠ” ì£¼ì¸ê³µ",
            "ğŸ”¥ ì„¸ìƒì„ êµ¬í•˜ê±°ë‚˜ ë¯¸ì…˜ì„ ìˆ˜í–‰í•˜ëŠ” íˆì–´ë¡œ",
            "ğŸŒŒ ë§ˆë²•ì´ë‚˜ ë¯¸ë˜ ì„¸ê³„ë¥¼ íƒí—˜í•˜ëŠ” íŠ¹ë³„í•œ ì¡´ì¬",
            "ğŸ˜‚ ì‚¬ê±´ì„ í„°ëœ¨ë¦¬ì§€ë§Œ ê²°êµ­ ì›ƒìŒì„ ì£¼ëŠ” ìºë¦­í„°",
        ],
    },
]

# ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
if "answers" not in st.session_state:
    st.session_state.answers = {}  # {"q1": "...", "q2": "...", ...}

if "submitted" not in st.session_state:
    st.session_state.submitted = False


def reset_test():
    """í…ŒìŠ¤íŠ¸ ì´ˆê¸°í™”"""
    st.session_state.answers = {}
    st.session_state.submitted = False

    # ë¼ë””ì˜¤ ì„ íƒê°’ë„ ì´ˆê¸°í™”(í‚¤ ì‚­ì œ)
    for i in range(1, len(questions) + 1):
        key = f"q{i}"
        if key in st.session_state:
            del st.session_state[key]


# ì§ˆë¬¸ í‘œì‹œ
for i, item in enumerate(questions, start=1):
    q_key = f"q{i}"

    # ë‹µë³€ì´ ì´ë¯¸ ìˆìœ¼ë©´ ê·¸ ê°’ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ìœ ì§€
    if q_key not in st.session_state.answers:
        # ì²˜ìŒ ë Œë”ë§ ì‹œ ê¸°ë³¸ê°’ì„ ì²« ë²ˆì§¸ ì„ íƒì§€ë¡œ ì €ì¥
        st.session_state.answers[q_key] = item["options"][0]

    st.subheader(item["q"])
    selected = st.radio(
        label=q_key,
        options=item["options"],
        key=q_key,
        label_visibility="collapsed",
    )

    # ì„¸ì…˜ ìƒíƒœì— ì €ì¥
    st.session_state.answers[q_key] = selected
    st.write("")

st.divider()

# ë²„íŠ¼ ì˜ì—­
col1, col2 = st.columns([1, 1])

with col1:
    if st.button("ê²°ê³¼ ë³´ê¸°", type="primary"):
        st.session_state.submitted = True

with col2:
    st.button("ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°", on_click=reset_test)

# ê²°ê³¼ í‘œì‹œ
if st.session_state.submitted:
    st.info("ë¶„ì„ ì¤‘... (ë‹¤ìŒ ì‹œê°„ì— TMDB ì¶”ì²œì„ ë¶™ì¼ ì˜ˆì •ì´ì—ìš”)")

    st.subheader("ğŸ“ ë‚´ ë‹µë³€ ëª¨ì•„ë³´ê¸°")
    for i, item in enumerate(questions, start=1):
        q_key = f"q{i}"
        st.write(f"**{item['q']}**")
        st.write(f"- {st.session_state.answers.get(q_key, 'ë¯¸ì„ íƒ')}")
        st.write("")
